"use strict";var f=Object.defineProperty;var C=Object.getOwnPropertyDescriptor;var I=Object.getOwnPropertyNames;var x=Object.prototype.hasOwnProperty;var k=(e,t)=>{for(var n in t)f(e,n,{get:t[n],enumerable:!0})},v=(e,t,n,a)=>{if(t&&typeof t=="object"||typeof t=="function")for(let i of I(t))!x.call(e,i)&&i!==n&&f(e,i,{get:()=>t[i],enumerable:!(a=C(t,i))||a.enumerable});return e};var R=e=>v(f({},"__esModule",{value:!0}),e);var L={};k(L,{checkSchedule:()=>w,default:()=>h});module.exports=R(L);var u=require("@raycast/api");var r=require("@raycast/api"),s=require("node:child_process");async function g(e,t,n){t&&await(0,r.showHUD)(t),await c({menubar:!1,status:!1});let a=M(n).split(/\s+/).filter(Boolean);(0,s.spawn)("/usr/bin/caffeinate",a,{detached:!0,stdio:"ignore"}).unref(),await m(e,!0)}async function c(e,t){t&&await(0,r.showHUD)(t),(0,s.execSync)("/usr/bin/killall caffeinate || true"),await m(e,!1)}async function m(e,t){e.menubar&&await p("index",{caffeinated:t}),e.status&&await p("status",{caffeinated:t})}async function p(e,t){try{await(0,r.launchCommand)({name:e,type:r.LaunchType.Background,context:t})}catch{}}function M(e){let t=(0,r.getPreferenceValues)(),n=[];t.preventDisplay&&n.push("d"),t.preventDisk&&n.push("m"),t.preventSystem&&n.push("i");let a=[];return n.length>0&&a.push(`-${n.join("")}`),e&&a.push(e),a.join(" ")}function S(){try{return(0,s.execSync)("pgrep caffeinate"),!0}catch{return!1}}function N(e){return["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"][e]}async function b(){let t=N(new Date().getDay()).toLowerCase(),n=await r.LocalStorage.getItem(t);return n===void 0?void 0:JSON.parse(n)}async function O(e){if(!e||Object.keys(e).length===0)return!1;let t=new Date,[n,a]=e.from.split(":").map(Number),[i,l]=e.to.split(":").map(Number),o=t.getHours(),d=t.getMinutes(),y=(o>n||o===n&&d>=a)&&(o<i||o===i&&d<l);if(y===!1&&e.IsRunning===!0)return e.IsRunning=!1,await c({menubar:!0,status:!0}),await u.LocalStorage.setItem(e.day,JSON.stringify(e)),!1;if(y===!0&&e.IsRunning===!1){let D=(i-n)*3600+(l-a)*60;return await g({menubar:!0,status:!0},void 0,`-t ${D}`),e.IsRunning=!0,await u.LocalStorage.setItem(e.day,JSON.stringify(e)),!0}return!1}async function w(){let e=await b();return e===void 0||e.IsManuallyDecafed?!1:await O(e)}async function h(){let e=S(),t=await w(),n="\u2716 Decaffeinated";(e||t)&&(n="\u2714 Caffeinated"),(0,u.updateCommandMetadata)({subtitle:n})}0&&(module.exports={checkSchedule});

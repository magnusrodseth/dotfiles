"use strict";var Re=Object.create;var j=Object.defineProperty;var Ae=Object.getOwnPropertyDescriptor;var Ce=Object.getOwnPropertyNames;var Ue=Object.getPrototypeOf,Te=Object.prototype.hasOwnProperty;var _e=(n,t)=>{for(var e in t)j(n,e,{get:t[e],enumerable:!0})},se=(n,t,e,r)=>{if(t&&typeof t=="object"||typeof t=="function")for(let a of Ce(t))!Te.call(n,a)&&a!==e&&j(n,a,{get:()=>t[a],enumerable:!(r=Ae(t,a))||r.enumerable});return n};var W=(n,t,e)=>(e=n!=null?Re(Ue(n)):{},se(t||!n||!n.__esModule?j(e,"default",{value:n,enumerable:!0}):e,n)),Pe=n=>se(j({},"__esModule",{value:!0}),n);var nt={};_e(nt,{default:()=>Ee});module.exports=Pe(nt);var v=require("@raycast/api");var f=W(require("react")),h=require("@raycast/api");var ie=Object.prototype.hasOwnProperty;function F(n,t){var e,r;if(n===t)return!0;if(n&&t&&(e=n.constructor)===t.constructor){if(e===Date)return n.getTime()===t.getTime();if(e===RegExp)return n.toString()===t.toString();if(e===Array){if((r=n.length)===t.length)for(;r--&&F(n[r],t[r]););return r===-1}if(!e||typeof n=="object"){r=0;for(e in n)if(ie.call(n,e)&&++r&&!ie.call(t,e)||!(e in t)||!F(n[e],t[e]))return!1;return Object.keys(t).length===r}}return n!==n&&t!==t}var D=W(require("node:fs")),G=W(require("node:path")),pe=W(require("node:crypto")),me=W(require("node:child_process")),be=require("node:buffer"),V=W(require("node:stream")),ge=require("node:util");var $e=require("react/jsx-runtime");var Y=globalThis;function Ie(n){let t=(0,f.useRef)(n),e=(0,f.useRef)(0);return F(n,t.current)||(t.current=n,e.current+=1),(0,f.useMemo)(()=>t.current,[e.current])}function k(n){let t=(0,f.useRef)(n);return t.current=n,t}function Oe(n,t){let e=n instanceof Error?n.message:String(n);return(0,h.showToast)({style:h.Toast.Style.Failure,title:t?.title??"Something went wrong",message:t?.message??e,primaryAction:t?.primaryAction??oe(n),secondaryAction:t?.primaryAction?oe(n):void 0})}var oe=n=>{let t=!0,e="[Extension Name]...",r="";try{let s=JSON.parse((0,D.readFileSync)((0,G.join)(h.environment.assetsPath,"..","package.json"),"utf8"));e=`[${s.title}]...`,r=`https://raycast.com/${s.owner||s.author}/${s.name}`,(!s.owner||s.access==="public")&&(t=!1)}catch{}let a=h.environment.isDevelopment||t,i=n instanceof Error?n?.stack||n?.message||"":String(n);return{title:a?"Copy Logs":"Report Error",onAction(s){s.hide(),a?h.Clipboard.copy(i):(0,h.open)(`https://github.com/raycast/extensions/issues/new?&labels=extension%2Cbug&template=extension_bug_report.yml&title=${encodeURIComponent(e)}&extension-url=${encodeURI(r)}&description=${encodeURIComponent(`#### Error:
\`\`\`
${i}
\`\`\`
`)}`)}}};function De(n,t,e){let r=(0,f.useRef)(0),[a,i]=(0,f.useState)({isLoading:!0}),s=k(n),c=k(e?.abortable),o=k(t||[]),u=k(e?.onError),l=k(e?.onData),p=k(e?.onWillExecute),$=k(e?.failureToastOptions),_=k(a.data),x=(0,f.useRef)(null),b=(0,f.useRef)({page:0}),w=(0,f.useRef)(!1),E=(0,f.useRef)(!0),L=(0,f.useRef)(50),g=(0,f.useCallback)(()=>(c.current&&(c.current.current?.abort(),c.current.current=new AbortController),++r.current),[c]),m=(0,f.useCallback)((...R)=>{let y=g();p.current?.(R),i(d=>({...d,isLoading:!0}));let I=Le(s.current)(...R);function O(d){return d.name=="AbortError"||y===r.current&&(u.current?u.current(d):h.environment.launchType!==h.LaunchType.Background&&Oe(d,{title:"Failed to fetch latest data",primaryAction:{title:"Retry",onAction(U){U.hide(),x.current?.(...o.current||[])}},...$.current}),i({error:d,isLoading:!1})),d}return typeof I=="function"?(w.current=!0,I(b.current).then(({data:d,hasMore:U,cursor:Z})=>(y===r.current&&(b.current&&(b.current.cursor=Z,b.current.lastItem=d?.[d.length-1]),l.current&&l.current(d,b.current),U&&(L.current=d.length),E.current=U,i(q=>b.current.page===0?{data:d,isLoading:!1}:{data:(q.data||[])?.concat(d),isLoading:!1})),d),d=>(E.current=!1,O(d)))):(w.current=!1,I.then(d=>(y===r.current&&(l.current&&l.current(d),i({data:d,isLoading:!1})),d),O))},[l,u,o,s,i,x,p,b,$,g]);x.current=m;let S=(0,f.useCallback)(()=>{b.current={page:0};let R=o.current||[];return m(...R)},[m,o]),C=(0,f.useCallback)(async(R,y)=>{let I;try{if(y?.optimisticUpdate){g(),typeof y?.rollbackOnError!="function"&&y?.rollbackOnError!==!1&&(I=structuredClone(_.current?.value));let O=y.optimisticUpdate;i(d=>({...d,data:O(d.data)}))}return await R}catch(O){if(typeof y?.rollbackOnError=="function"){let d=y.rollbackOnError;i(U=>({...U,data:d(U.data)}))}else y?.optimisticUpdate&&y?.rollbackOnError!==!1&&i(d=>({...d,data:I}));throw O}finally{y?.shouldRevalidateAfter!==!1&&(h.environment.launchType===h.LaunchType.Background||h.environment.commandMode==="menu-bar"?await S():S())}},[S,_,i,g]),M=(0,f.useCallback)(()=>{b.current.page+=1;let R=o.current||[];m(...R)},[b,o,m]);(0,f.useEffect)(()=>{b.current={page:0},e?.execute!==!1?m(...t||[]):g()},[Ie([t,e?.execute,m]),c,b]),(0,f.useEffect)(()=>()=>{g()},[g]);let P=e?.execute!==!1?a.isLoading:!1,N={...a,isLoading:P},J=w.current?{pageSize:L.current,hasMore:E.current,onLoadMore:M}:void 0;return{...N,revalidate:S,mutate:C,pagination:J}}function Le(n){return n===Promise.all||n===Promise.race||n===Promise.resolve||n===Promise.reject?n.bind(Promise):n}function ce(n){return typeof n!="function"?!1:/^function\s+\w*\s*\(\s*\)\s*{\s+\[native code\]\s+}$/i.exec(Function.prototype.toString.call(n))!==null}function Me(n){return n instanceof URLSearchParams?n.toString():n}function ye(n,t=[]){function e(r){return"update"in n?n.update(r,"utf8"):n.write(r)}return{dispatch:function(r){r=Me(r),r===null?this._null():this["_"+typeof r](r)},_object:function(r){let a=/\[object (.*)\]/i,i=Object.prototype.toString.call(r),s=a.exec(i)?.[1]??"unknown:["+i+"]";s=s.toLowerCase();let c=null;if((c=t.indexOf(r))>=0){this.dispatch("[CIRCULAR:"+c+"]");return}else t.push(r);if(Buffer.isBuffer(r))return e("buffer:"),e(r.toString("utf8"));if(s!=="object"&&s!=="function"&&s!=="asyncfunction")if(this["_"+s])this["_"+s](r);else throw new Error('Unknown object type "'+s+'"');else{let o=Object.keys(r);o=o.sort(),ce(r)||o.splice(0,0,"prototype","__proto__","constructor"),e("object:"+o.length+":");let u=this;return o.forEach(function(l){u.dispatch(l),e(":"),u.dispatch(r[l]),e(",")})}},_array:function(r,a){a=typeof a<"u"?a:!1;let i=this;if(e("array:"+r.length+":"),!a||r.length<=1){r.forEach(function(o){i.dispatch(o)});return}let s=[],c=r.map(function(o){let u=We(),l=t.slice();return ye(u,l).dispatch(o),s=s.concat(l.slice(t.length)),u.read().toString()});t=t.concat(s),c.sort(),this._array(c,!1)},_date:function(r){e("date:"+r.toJSON())},_symbol:function(r){e("symbol:"+r.toString())},_error:function(r){e("error:"+r.toString())},_boolean:function(r){e("bool:"+r.toString())},_string:function(r){e("string:"+r.length+":"),e(r.toString())},_function:function(r){e("fn:"),ce(r)?this.dispatch("[native]"):this.dispatch(r.toString()),this.dispatch("function-name:"+String(r.name)),this._object(r)},_number:function(r){e("number:"+r.toString())},_xml:function(r){e("xml:"+r.toString())},_null:function(){e("Null")},_undefined:function(){e("Undefined")},_regexp:function(r){e("regex:"+r.toString())},_uint8array:function(r){e("uint8array:"),this.dispatch(Array.prototype.slice.call(r))},_uint8clampedarray:function(r){e("uint8clampedarray:"),this.dispatch(Array.prototype.slice.call(r))},_int8array:function(r){e("int8array:"),this.dispatch(Array.prototype.slice.call(r))},_uint16array:function(r){e("uint16array:"),this.dispatch(Array.prototype.slice.call(r))},_int16array:function(r){e("int16array:"),this.dispatch(Array.prototype.slice.call(r))},_uint32array:function(r){e("uint32array:"),this.dispatch(Array.prototype.slice.call(r))},_int32array:function(r){e("int32array:"),this.dispatch(Array.prototype.slice.call(r))},_float32array:function(r){e("float32array:"),this.dispatch(Array.prototype.slice.call(r))},_float64array:function(r){e("float64array:"),this.dispatch(Array.prototype.slice.call(r))},_arraybuffer:function(r){e("arraybuffer:"),this.dispatch(new Uint8Array(r))},_url:function(r){e("url:"+r.toString())},_map:function(r){e("map:");let a=Array.from(r);this._array(a,!0)},_set:function(r){e("set:");let a=Array.from(r);this._array(a,!0)},_file:function(r){e("file:"),this.dispatch([r.name,r.size,r.type,r.lastModified])},_blob:function(){throw Error(`Hashing Blob objects is currently not supported
(see https://github.com/puleos/object-hash/issues/26)
Use "options.replacer" or "options.ignoreUnknown"
`)},_domwindow:function(){e("domwindow")},_bigint:function(r){e("bigint:"+r.toString())},_process:function(){e("process")},_timer:function(){e("timer")},_pipe:function(){e("pipe")},_tcp:function(){e("tcp")},_udp:function(){e("udp")},_tty:function(){e("tty")},_statwatcher:function(){e("statwatcher")},_securecontext:function(){e("securecontext")},_connection:function(){e("connection")},_zlib:function(){e("zlib")},_context:function(){e("context")},_nodescript:function(){e("nodescript")},_httpparser:function(){e("httpparser")},_dataview:function(){e("dataview")},_signal:function(){e("signal")},_fsevent:function(){e("fsevent")},_tlswrap:function(){e("tlswrap")}}}function We(){return{buf:"",write:function(n){this.buf+=n},end:function(n){this.buf+=n},read:function(){return this.buf}}}function ze(n,t){let e=this[n];return e instanceof Date?`__raycast_cached_date__${e.toISOString()}`:Buffer.isBuffer(e)?`__raycast_cached_buffer__${e.toString("base64")}`:t}function Ve(n,t){return typeof t=="string"&&t.startsWith("__raycast_cached_date__")?new Date(t.replace("__raycast_cached_date__","")):typeof t=="string"&&t.startsWith("__raycast_cached_buffer__")?Buffer.from(t.replace("__raycast_cached_buffer__",""),"base64"):t}function ue(n){let t=pe.default.createHash("sha1");return ye(t).dispatch(n),t.digest("hex")}var Ne=Symbol("cache without namespace"),le=new Map;function je(n,t,e){let r=e?.cacheNamespace||Ne,a=le.get(r)||le.set(r,new h.Cache({namespace:e?.cacheNamespace})).get(r);if(!a)throw new Error("Missing cache");let i=k(n),s=k(t),c=(0,f.useSyncExternalStore)(a.subscribe,()=>{try{return a.get(i.current)}catch(p){console.error("Could not get Cache data:",p);return}}),o=(0,f.useMemo)(()=>{if(typeof c<"u"){if(c==="undefined")return;try{return JSON.parse(c,Ve)}catch(p){return console.warn("The cached data is corrupted",p),s.current}}else return s.current},[c,s]),u=k(o),l=(0,f.useCallback)(p=>{let $=typeof p=="function"?p(u.current):p;if(typeof $>"u")a.set(i.current,"undefined");else{let _=JSON.stringify($,ze);a.set(i.current,_)}return $},[a,i,u]);return[o,l]}var z=Symbol();function Fe(n,t,e){let{initialData:r,keepPreviousData:a,internal_cacheKeySuffix:i,...s}=e||{},c=(0,f.useRef)(null),[o,u]=je(ue(t||[])+i,z,{cacheNamespace:ue(n)}),l=(0,f.useRef)(o!==z?o:r),p=(0,f.useRef)(void 0),{mutate:$,revalidate:_,...x}=De(n,t||[],{...s,onData(g,m){p.current=m,s.onData&&s.onData(g,m),!(m&&m.page>0)&&(c.current="promise",l.current=g,u(g))}}),b,w=x.pagination;p.current&&p.current.page>0&&x.data?b=x.data:c.current==="promise"?b=l.current:a&&o!==z?(b=o,w&&(w.hasMore=!0,w.pageSize=o.length)):a&&o===z?b=l.current:o!==z?(b=o,w&&(w.hasMore=!0,w.pageSize=o.length)):b=r;let E=k(b),L=(0,f.useCallback)(async(g,m)=>{let S;try{if(m?.optimisticUpdate){typeof m?.rollbackOnError!="function"&&m?.rollbackOnError!==!1&&(S=structuredClone(E.current));let C=m.optimisticUpdate(E.current);c.current="cache",l.current=C,u(C)}return await $(g,{shouldRevalidateAfter:m?.shouldRevalidateAfter})}catch(C){if(typeof m?.rollbackOnError=="function"){let M=m.rollbackOnError(E.current);c.current="cache",l.current=M,u(M)}else m?.optimisticUpdate&&m?.rollbackOnError!==!1&&(c.current="cache",l.current=S,u(S));throw C}},[u,$,E,l,c]);return(0,f.useEffect)(()=>{o!==z&&(c.current="cache",l.current=o)},[o]),{data:b,isLoading:x.isLoading,error:x.error,mutate:p.current&&p.current.page>0?$:L,pagination:w,revalidate:_}}var B=n=>!!n&&typeof n=="object"&&typeof n.removeListener=="function"&&typeof n.emit=="function"&&typeof n.reallyExit=="function"&&typeof n.listeners=="function"&&typeof n.kill=="function"&&typeof n.pid=="number"&&typeof n.on=="function",X=Symbol.for("signal-exit emitter"),ee=class{constructor(){if(this.emitted={afterExit:!1,exit:!1},this.listeners={afterExit:[],exit:[]},this.count=0,this.id=Math.random(),Y[X])return Y[X];Object.defineProperty(Y,X,{value:this,writable:!1,enumerable:!1,configurable:!1})}on(t,e){this.listeners[t].push(e)}removeListener(t,e){let r=this.listeners[t],a=r.indexOf(e);a!==-1&&(a===0&&r.length===1?r.length=0:r.splice(a,1))}emit(t,e,r){if(this.emitted[t])return!1;this.emitted[t]=!0;let a=!1;for(let i of this.listeners[t])a=i(e,r)===!0||a;return t==="exit"&&(a=this.emit("afterExit",e,r)||a),a}},te=class{onExit(){return()=>{}}load(){}unload(){}},re=class{#o;#t;#e;#s;#i;#a;#n;#r;constructor(t){this.#o=process.platform==="win32"?"SIGINT":"SIGHUP",this.#t=new ee,this.#a={},this.#n=!1,this.#r=[],this.#r.push("SIGHUP","SIGINT","SIGTERM"),globalThis.process.platform!=="win32"&&this.#r.push("SIGALRM","SIGABRT","SIGVTALRM","SIGXCPU","SIGXFSZ","SIGUSR2","SIGTRAP","SIGSYS","SIGQUIT","SIGIOT"),globalThis.process.platform==="linux"&&this.#r.push("SIGIO","SIGPOLL","SIGPWR","SIGSTKFLT"),this.#e=t,this.#a={};for(let e of this.#r)this.#a[e]=()=>{let r=this.#e.listeners(e),{count:a}=this.#t,i=t;if(typeof i.__signal_exit_emitter__=="object"&&typeof i.__signal_exit_emitter__.count=="number"&&(a+=i.__signal_exit_emitter__.count),r.length===a){this.unload();let s=this.#t.emit("exit",null,e),c=e==="SIGHUP"?this.#o:e;s||t.kill(t.pid,c)}};this.#i=t.reallyExit,this.#s=t.emit}onExit(t,e){if(!B(this.#e))return()=>{};this.#n===!1&&this.load();let r=e?.alwaysLast?"afterExit":"exit";return this.#t.on(r,t),()=>{this.#t.removeListener(r,t),this.#t.listeners.exit.length===0&&this.#t.listeners.afterExit.length===0&&this.unload()}}load(){if(!this.#n){this.#n=!0,this.#t.count+=1;for(let t of this.#r)try{let e=this.#a[t];e&&this.#e.on(t,e)}catch{}this.#e.emit=(t,...e)=>this.#u(t,...e),this.#e.reallyExit=t=>this.#c(t)}}unload(){this.#n&&(this.#n=!1,this.#r.forEach(t=>{let e=this.#a[t];if(!e)throw new Error("Listener not defined for signal: "+t);try{this.#e.removeListener(t,e)}catch{}}),this.#e.emit=this.#s,this.#e.reallyExit=this.#i,this.#t.count-=1)}#c(t){return B(this.#e)?(this.#e.exitCode=t||0,this.#t.emit("exit",this.#e.exitCode,null),this.#i.call(this.#e,this.#e.exitCode)):0}#u(t,...e){let r=this.#s;if(t==="exit"&&B(this.#e)){typeof e[0]=="number"&&(this.#e.exitCode=e[0]);let a=r.call(this.#e,t,...e);return this.#t.emit("exit",this.#e.exitCode,null),a}else return r.call(this.#e,t,...e)}},Q=null,Be=(n,t)=>(Q||(Q=B(process)?new re(process):new te),Q.onExit(n,t));function Ge(n,{timeout:t}={}){let e=new Promise((c,o)=>{n.on("exit",(u,l)=>{c({exitCode:u,signal:l,timedOut:!1})}),n.on("error",u=>{o(u)}),n.stdin&&n.stdin.on("error",u=>{o(u)})}),r=Be(()=>{n.kill()});if(t===0||t===void 0)return e.finally(()=>r());let a,i=new Promise((c,o)=>{a=setTimeout(()=>{n.kill("SIGTERM"),o(Object.assign(new Error("Timed out"),{timedOut:!0,signal:"SIGTERM"}))},t)}),s=e.finally(()=>{clearTimeout(a)});return Promise.race([i,s]).finally(()=>r())}var ne=class extends Error{constructor(){super("The output is too big"),this.name="MaxBufferError"}};function Ke(n){let{encoding:t}=n,e=t==="buffer",r=new V.default.PassThrough({objectMode:!1});t&&t!=="buffer"&&r.setEncoding(t);let a=0,i=[];return r.on("data",s=>{i.push(s),a+=s.length}),r.getBufferedValue=()=>e?Buffer.concat(i,a):i.join(""),r.getBufferedLength=()=>a,r}async function fe(n,t){let e=Ke(t);return await new Promise((r,a)=>{let i=s=>{s&&e.getBufferedLength()<=be.constants.MAX_LENGTH&&(s.bufferedData=e.getBufferedValue()),a(s)};(async()=>{try{await(0,ge.promisify)(V.default.pipeline)(n,e),r()}catch(s){i(s)}})(),e.on("data",()=>{e.getBufferedLength()>8e7&&i(new ne)})}),e.getBufferedValue()}async function de(n,t){n.destroy();try{return await t}catch(e){return e.bufferedData}}async function He({stdout:n,stderr:t},{encoding:e},r){let a=fe(n,{encoding:e}),i=fe(t,{encoding:e});try{return await Promise.all([r,a,i])}catch(s){return Promise.all([{error:s,exitCode:null,signal:s.signal,timedOut:s.timedOut||!1},de(n,a),de(t,i)])}}function Je(n){let t=typeof n=="string"?`
`:10,e=typeof n=="string"?"\r":13;return n[n.length-1]===t&&(n=n.slice(0,-1)),n[n.length-1]===e&&(n=n.slice(0,-1)),n}function he(n,t){return n.stripFinalNewline?Je(t):t}function Ze({timedOut:n,timeout:t,signal:e,exitCode:r}){return n?`timed out after ${t} milliseconds`:e!=null?`was killed with ${e}`:r!=null?`failed with exit code ${r}`:"failed"}function qe({stdout:n,stderr:t,error:e,signal:r,exitCode:a,command:i,timedOut:s,options:c,parentError:o}){let l=`Command ${Ze({timedOut:s,timeout:c?.timeout,signal:r,exitCode:a})}: ${i}`,p=e?`${l}
${e.message}`:l,$=[p,t,n].filter(Boolean).join(`
`);return e?e.originalMessage=e.message:e=o,e.message=$,e.shortMessage=p,e.command=i,e.exitCode=a,e.signal=r,e.stdout=n,e.stderr=t,"bufferedData"in e&&delete e.bufferedData,e}function Ye({stdout:n,stderr:t,error:e,exitCode:r,signal:a,timedOut:i,command:s,options:c,parentError:o}){if(e||r!==0||a!==null)throw qe({error:e,exitCode:r,signal:a,stdout:n,stderr:t,command:s,timedOut:i,options:c,parentError:o});return n}var Xe=/ +/g;function Qe(n,t){if(t)return[n,...t];let e=[];for(let r of n.trim().split(Xe)){let a=e[e.length-1];a&&a.endsWith("\\")?e[e.length-1]=`${a.slice(0,-1)} ${r}`:e.push(r)}return e}function we(n,t,e){let{parseOutput:r,input:a,onData:i,onWillExecute:s,initialData:c,execute:o,keepPreviousData:u,onError:l,failureToastOptions:p,...$}=Array.isArray(t)?e||{}:t||{},_={initialData:c,execute:o,keepPreviousData:u,onError:l,onData:i,onWillExecute:s,failureToastOptions:p},x=(0,f.useRef)(null),b=k(r||Ye),w=(0,f.useCallback)(async(E,L,g,m)=>{let[S,...C]=Qe(E,L),M=[S,...C].join(" "),P={stripFinalNewline:!0,...g,timeout:g?.timeout||1e4,signal:x.current?.signal,encoding:g?.encoding===null?"buffer":g?.encoding||"utf8",env:{PATH:"/usr/local/bin:/usr/bin:/bin:/usr/sbin:/sbin",...process.env,...g?.env}},N=me.default.spawn(S,C,P),J=Ge(N,P);m&&N.stdin.end(m);let[{error:R,exitCode:y,signal:I,timedOut:O},d,U]=await He(N,P,J),Z=he(P,d),q=he(P,U);return b.current({stdout:Z,stderr:q,error:R,exitCode:y,signal:I,timedOut:O,command:M,options:P,parentError:new Error})},[b]);return Fe(w,[n,Array.isArray(t)?t:[],$,a],{..._,abortable:x})}var H=require("react");var A=require("@raycast/api"),K=require("node:child_process");async function xe(n,t,e){t&&await(0,A.showHUD)(t),await ae({menubar:!1,status:!1});let r=et(e).split(/\s+/).filter(Boolean);(0,K.spawn)("/usr/bin/caffeinate",r,{detached:!0,stdio:"ignore"}).unref(),await ve(n,!0)}async function ae(n,t){t&&await(0,A.showHUD)(t),(0,K.execSync)("/usr/bin/killall caffeinate || true"),await ve(n,!1)}async function ve(n,t){n.menubar&&await ke("index",{caffeinated:t}),n.status&&await ke("status",{caffeinated:t})}async function ke(n,t){try{await(0,A.launchCommand)({name:n,type:A.LaunchType.Background,context:t})}catch{}}function et(n){let t=(0,A.getPreferenceValues)(),e=[];t.preventDisplay&&e.push("d"),t.preventDisk&&e.push("m"),t.preventSystem&&e.push("i");let r=[];return e.length>0&&r.push(`-${e.join("")}`),n&&r.push(n),r.join(" ")}function Se(n){let t=[{label:"d",value:86400},{label:"h",value:3600},{label:"m",value:60},{label:"s",value:1}],e=[];for(let r of t){let a=Math.floor(n/r.value);n%=r.value,a>0&&e.push(`${a}${r.label}`)}return e.join(" ")}var T=require("react/jsx-runtime");function tt(n){let t=n.split(":").reverse(),e=parseInt(t[0])||0,r=parseInt(t[1])||0,a=t[2]?parseInt(t[2]):0,i=0;if(t[2]&&t[2].includes("-")){let s=t[2].split("-");i=parseInt(s[0])||0,a=parseInt(s[1])||0}return e+r*60+a*3600+i*86400}function rt(n){let{isLoading:t,data:e,mutate:r}=we("ps -o etime,args= -p $(pgrep caffeinate) 2>/dev/null",[],{shell:!0,execute:n,parseOutput:a=>{let i=a.stdout.trim();if(!i)return{isRunning:!1,timeRemaining:null};let s=i.split(`
`),[c,...o]=s[s.length-1].trim().split(/\s+/),u=tt(c),l=o.join(" ").match(/-t (\d+)/),p=null;if(l){let $=parseInt(l[1])-u;$>0&&(p=`${Se($)} remain`)}return{isRunning:!0,timeRemaining:p}}});return{isLoading:t,data:e??{isRunning:!1,timeRemaining:null},mutate:r}}function Ee(n){let t=n.launchContext?.caffeinated!==void 0,{isLoading:e,data:r,mutate:a}=rt(!0),i=t?n?.launchContext?.caffeinated:r.isRunning,s=t?!1:e,c=(0,v.getPreferenceValues)(),o=r.timeRemaining,[u,l]=(0,H.useState)(i);(0,H.useEffect)(()=>{l(i)},[i]);let p=async()=>{u?(l(!1),await a(ae({menubar:!0,status:!0}),{optimisticUpdate:()=>({isRunning:!1,timeRemaining:null})}),c.hidenWhenDecaffeinated&&(0,v.showHUD)("Your Mac is now decaffeinated")):(l(!0),await a(xe({menubar:!0,status:!0}),{optimisticUpdate:()=>({isRunning:!0,timeRemaining:null})}))};return c.hidenWhenDecaffeinated&&!u&&!e?null:(0,T.jsx)(v.MenuBarExtra,{isLoading:s,icon:u?{source:`${c.icon}-filled.svg`,tintColor:v.Color.PrimaryText}:{source:`${c.icon}-empty.svg`,tintColor:v.Color.PrimaryText},children:e?null:(0,T.jsxs)(T.Fragment,{children:[(0,T.jsx)(v.MenuBarExtra.Section,{title:`Your mac is ${u?"caffeinated":"decaffeinated"}`}),u&&o&&(0,T.jsx)(v.MenuBarExtra.Section,{title:o}),(0,T.jsx)(v.MenuBarExtra.Item,{title:u?"Decaffeinate":"Caffeinate",onAction:p})]})})}

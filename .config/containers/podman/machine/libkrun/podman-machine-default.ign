{"ignition":{"config":{"replace":{"verification":{}}},"proxy":{},"security":{"tls":{}},"timeouts":{},"version":"3.2.0"},"passwd":{"users":[{"name":"core","sshAuthorizedKeys":["ssh-ed25519 AAAAC3NzaC1lZDI1NTE5AAAAIEHh+g4X1tZbv3VngdqNyX69aOuThTR4P7Wqkl1s5Pvc magnus.rodseth@CM-C72TN4CKPW"],"uid":501},{"name":"root","sshAuthorizedKeys":["ssh-ed25519 AAAAC3NzaC1lZDI1NTE5AAAAIEHh+g4X1tZbv3VngdqNyX69aOuThTR4P7Wqkl1s5Pvc magnus.rodseth@CM-C72TN4CKPW"]}]},"storage":{"directories":[{"group":{"name":"core"},"path":"/home/core/.config","user":{"name":"core"},"mode":493},{"group":{"name":"core"},"path":"/home/core/.config/containers","user":{"name":"core"},"mode":493},{"group":{"name":"core"},"path":"/home/core/.config/systemd","user":{"name":"core"},"mode":493},{"group":{"name":"core"},"path":"/home/core/.config/systemd/user","user":{"name":"core"},"mode":493}],"files":[{"group":{"name":"root"},"overwrite":true,"path":"/var/lib/systemd/linger/core","user":{"name":"root"},"contents":{"source":"data:,","verification":{}},"mode":420},{"group":{"name":"core"},"path":"/home/core/.config/containers/containers.conf","user":{"name":"core"},"contents":{"source":"data:,%5Bcontainers%5D%0Anetns=%22bridge%22%0Apids_limit=0%0A","verification":{}},"mode":484},{"group":{"name":"root"},"overwrite":true,"path":"/etc/subuid","user":{"name":"root"},"contents":{"source":"data:,core:100000:1000000","verification":{}},"mode":484},{"group":{"name":"root"},"overwrite":true,"path":"/etc/subgid","user":{"name":"root"},"contents":{"source":"data:,core:100000:1000000","verification":{}},"mode":484},{"group":{"name":"root"},"path":"/etc/containers/podman-machine","user":{"name":"root"},"contents":{"source":"data:,libkrun%0A","verification":{}},"mode":420},{"group":{},"path":"/etc/tmpfiles.d/podman-docker.conf","user":{},"contents":{"source":"data:,L+%20%20%2Frun%2Fdocker.sock%20%20%20-%20%20%20%20-%20%20%20%20-%20%20%20%20%20-%20%20%20%2Frun%2Fpodman%2Fpodman.sock%0A","verification":{}},"mode":420},{"group":{"name":"core"},"path":"/home/core/playbook.yaml","user":{"name":"core"},"contents":{"source":"data:,---%0A-%20name:%20Create%20a%20symbolic%20link%20for%20registries.conf%20from%20host%20to%20VM%0A%20%20hosts:%20localhost%0A%20%20become:%20true%0A%20%20tasks:%0A%20%20%20%20-%20name:%20Create%20symbolic%20link%20with%20sudo%20from%20the%20host%0A%20%20%20%20%20%20command:%20sudo%20ln%20-s%20%2FUsers%2Fmagnus.rodseth%2F.config%2Fcontainers%2Fregistries.conf%20%2Fetc%2Fcontainers%2Fregistries.conf.d%2F999-podman-desktop-registries-from-host.conf%0A","verification":{}},"mode":484}],"links":[{"group":{"name":"root"},"overwrite":true,"path":"/etc/systemd/user/sockets.target.wants/podman.socket","user":{"name":"root"},"hard":false,"target":"/usr/lib/systemd/user/podman.socket"},{"group":{"name":"root"},"overwrite":true,"path":"/usr/local/bin/docker","user":{"name":"root"},"hard":false,"target":"/usr/bin/podman"},{"group":{"name":"root"},"overwrite":false,"path":"/etc/localtime","user":{"name":"root"},"hard":false,"target":"../usr/share/zoneinfo/Europe/Oslo"}]},"systemd":{"units":[{"enabled":true,"name":"podman.socket"},{"enabled":false,"name":"zincati.service"},{"contents":"[Unit]\nAfter=ready.service\nConditionFirstBoot=yes\n\n[Service]\nType=oneshot\nUser=core\nGroup=core\nExecStart=ansible-playbook /home/core/playbook.yaml\n\n[Install]\nWantedBy=default.target\n","enabled":true,"name":"playbook.service"},{"contents":"[Unit]\nAfter=sshd.socket sshd.service\nOnFailure=emergency.target\nOnFailureJobMode=isolate\nRequires=dev-virtio\\x2dports-vsock.device\n\n[Service]\nType=oneshot\nRemainAfterExit=yes\nExecStart=/bin/sh -c '/usr/bin/echo Ready | socat - VSOCK-CONNECT:2:1025'\n\n[Install]\nRequiredBy=default.target\n","enabled":true,"name":"ready.service"},{"contents":"[Mount]\nWhat=a2a0ee2c717462feb1de2f5afd59de5fd2d8\nWhere=/Users\nType=virtiofs\nOptions=context=\"system_u:object_r:nfs_t:s0\"\n\n[Install]\nWantedBy=multi-user.target\n","enabled":true,"name":"Users.mount"},{"contents":"[Mount]\nWhat=71708eb255bc230cd7c91dd26f7667a7b938\nWhere=/private\nType=virtiofs\nOptions=context=\"system_u:object_r:nfs_t:s0\"\n\n[Install]\nWantedBy=multi-user.target\n","enabled":true,"name":"private.mount"},{"contents":"[Mount]\nWhat=a0bb3a2c8b0b02ba5958b0576f0d6530e104\nWhere=/var/folders\nType=virtiofs\nOptions=context=\"system_u:object_r:nfs_t:s0\"\n\n[Install]\nWantedBy=multi-user.target\n","enabled":true,"name":"var-folders.mount"},{"contents":"[Unit]\nDescription=Allow systemd to create mount points on /\nDefaultDependencies=no\n\n[Service]\nType=oneshot\nExecStart=chattr -i /\n\n[Install]\nWantedBy=remote-fs-pre.target\n","enabled":true,"name":"immutable-root-off.service"},{"contents":"[Unit]\nDescription=Set / back to immutable after mounts are done\nDefaultDependencies=no\nAfter=remote-fs.target\n\n[Service]\nType=oneshot\nExecStart=chattr +i /\n\n[Install]\nWantedBy=remote-fs.target\n","enabled":true,"name":"immutable-root-on.service"}]}}